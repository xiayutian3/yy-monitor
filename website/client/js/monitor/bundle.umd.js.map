{"version":3,"file":"bundle.umd.js","sources":["../../../../sdk/errorCatch.js","../../../../sdk/index.js"],"sourcesContent":["//错误捕获监控\r\n\r\nlet formatError = (errorObj) => {\r\n  // debugger\r\n  // 兼容 火狐 苹果浏览器\r\n  let col = errorObj.column || errorObj.columnNumber\r\n  let row = errorObj.line || errorObj.lineNumber\r\n  let errorType = errorObj.name\r\n  let message = errorObj.message\r\n\r\n  let { stack } = errorObj\r\n  if (stack) {\r\n    // urlFirstStack 里面有报错url和报错位置\r\n    let matchUrl = stack.match(/https?:\\/\\/[^\\n]+/)\r\n    let urlFirstStack = matchUrl ? matchUrl[0] : ''\r\n    // \"http://localhost:3003/js/main.js:32:3)\"\r\n\r\n    //获取真正的url\r\n    let resourceUrl = '';\r\n    let regUrlCheck = /https?:\\/\\/(\\S)*\\.js/\r\n    if(regUrlCheck.test(urlFirstStack)){\r\n      resourceUrl = urlFirstStack.match(regUrlCheck)[0]\r\n    }\r\n\r\n    //获取报错文件的行列信息\r\n    let stackCol = null\r\n    let stackRow = null\r\n    let posStack = urlFirstStack.match(/:(\\d+):(\\d+)/)\r\n    if(posStack && posStack.length>=3){\r\n      [,stackCol,stackRow] = posStack\r\n    }\r\n    \r\n    return {\r\n      content:stack,\r\n      col:Number(col || stackCol),\r\n      row:Number(row || stackRow),\r\n      errorType, \r\n      message, \r\n      resourceUrl\r\n    }\r\n  }\r\n}\r\n\r\nexport default {\r\n  init: (cb) => {\r\n    let _origin_error = window.onerror\r\n    window.onerror = function (message, source, lineno, colno, error) {\r\n\r\n      let errorInfo = formatError(error)\r\n      //原本就有的错误\r\n      errorInfo._message = message\r\n      errorInfo._source = source\r\n      errorInfo._lineno = lineno\r\n      errorInfo._colno = colno\r\n\r\n      errorInfo.type = 'error'\r\n      //上报错误信息\r\n      cb(errorInfo)\r\n      _origin_error && _origin_error.apply(window, arguments)\r\n    }\r\n    // cb()\r\n  }\r\n}","import perf from './perf'\r\nimport resource from './resource'\r\nimport errorCatch from './errorCatch'\r\nimport xhrHook from './xhrHook'\r\n\r\n\r\n//性能指标\r\n// perf.init((perfData)=>{\r\n//   //performance timing\r\n//   // console.log('perfData: ', perfData);\r\n//   // console.log('perf init')\r\n// })\r\n\r\n//资源监控\r\n// resource.init((resource)=>{\r\n//   console.log('resource: ', resource);\r\n// })\r\n\r\n//请求监控\r\n// console.log('xhrHook: ', xhrHook);\r\n// xhrHook.init((infoData)=>{\r\n//   console.log('infoData: ', infoData);\r\n// })\r\n\r\n//错误捕获\r\nerrorCatch.init((errorInfo)=>{\r\n  console.log('errorInfo',errorInfo)\r\n})"],"names":["formatError","errorObj","col","column","columnNumber","row","line","lineNumber","errorType","name","message","stack","matchUrl","match","urlFirstStack","resourceUrl","regUrlCheck","test","stackCol","stackRow","posStack","length","content","Number","init","cb","_origin_error","window","onerror","source","lineno","colno","error","errorInfo","_message","_source","_lineno","_colno","type","apply","arguments","errorCatch","console","log"],"mappings":";;;;;;;EAAA;;EAEA,IAAIA,cAAc,SAAdA,WAAc,CAACC,QAAD,EAAc;EAC9B;EACA;EACA,MAAIC,MAAMD,SAASE,MAAT,IAAmBF,SAASG,YAAtC;EACA,MAAIC,MAAMJ,SAASK,IAAT,IAAiBL,SAASM,UAApC;EACA,MAAIC,YAAYP,SAASQ,IAAzB;EACA,MAAIC,UAAUT,SAASS,OAAvB;;EAN8B,MAQxBC,KARwB,GAQdV,QARc,CAQxBU,KARwB;;EAS9B,MAAIA,KAAJ,EAAW;EACT;EACA,QAAIC,WAAWD,MAAME,KAAN,CAAY,mBAAZ,CAAf;EACA,QAAIC,gBAAgBF,WAAWA,SAAS,CAAT,CAAX,GAAyB,EAA7C;EACA;;EAEA;EACA,QAAIG,cAAc,EAAlB;EACA,QAAIC,cAAc,sBAAlB;EACA,QAAGA,YAAYC,IAAZ,CAAiBH,aAAjB,CAAH,EAAmC;EACjCC,oBAAcD,cAAcD,KAAd,CAAoBG,WAApB,EAAiC,CAAjC,CAAd;EACD;;EAED;EACA,QAAIE,WAAW,IAAf;EACA,QAAIC,WAAW,IAAf;EACA,QAAIC,WAAWN,cAAcD,KAAd,CAAoB,cAApB,CAAf;EACA,QAAGO,YAAYA,SAASC,MAAT,IAAiB,CAAhC,EAAkC;EAAA,qCACTD,QADS;;EAC9BF,cAD8B;EACrBC,cADqB;EAEjC;;EAED,WAAO;EACLG,eAAQX,KADH;EAELT,WAAIqB,OAAOrB,OAAOgB,QAAd,CAFC;EAGLb,WAAIkB,OAAOlB,OAAOc,QAAd,CAHC;EAILX,0BAJK;EAKLE,sBALK;EAMLK;EANK,KAAP;EAQD;EACF,CAvCD;;AAyCA,mBAAe;EACbS,QAAM,cAACC,EAAD,EAAQ;EACZ,QAAIC,gBAAgBC,OAAOC,OAA3B;EACAD,WAAOC,OAAP,GAAiB,UAAUlB,OAAV,EAAmBmB,MAAnB,EAA2BC,MAA3B,EAAmCC,KAAnC,EAA0CC,KAA1C,EAAiD;;EAEhE,UAAIC,YAAYjC,YAAYgC,KAAZ,CAAhB;EACA;EACAC,gBAAUC,QAAV,GAAqBxB,OAArB;EACAuB,gBAAUE,OAAV,GAAoBN,MAApB;EACAI,gBAAUG,OAAV,GAAoBN,MAApB;EACAG,gBAAUI,MAAV,GAAmBN,KAAnB;;EAEAE,gBAAUK,IAAV,GAAiB,OAAjB;EACA;EACAb,SAAGQ,SAAH;EACAP,uBAAiBA,cAAca,KAAd,CAAoBZ,MAApB,EAA4Ba,SAA5B,CAAjB;EACD,KAbD;EAcA;EACD;EAlBY,CAAf;;ECrCA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;;EAEA;EACAC,WAAWjB,IAAX,CAAgB,UAACS,SAAD,EAAa;EAC3BS,UAAQC,GAAR,CAAY,WAAZ,EAAwBV,SAAxB;EACD,CAFD;;;;;;"}